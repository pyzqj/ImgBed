import{_ as D,u as I,j as S,c as k,f as F,a as o,w,b as t,v as i,t as b,d as x,s as N,h as A,i as y,r,o as P}from"./index-fsJvMXAk.js";import{N as H}from"./Navbar-jp9is5ex.js";import"./image-DM1O7qIR.js";const L={class:"settings-page"},_={class:"container"},z={class:"settings-sections"},M={class:"section ghibli-card"},$={class:"form-group"},q={class:"form-group"},E={class:"form-group"},R={key:0,class:"ghibli-error"},j={key:1,class:"ghibli-success"},G=["disabled"],J={class:"section ghibli-card"},K={class:"form-group"},O={class:"form-group"},Q=["disabled"],W={class:"section ghibli-card"},X={class:"form-group"},Y={class:"form-group"},Z={class:"form-group"},ee={class:"form-group checkbox"},oe=["disabled"],se={class:"section ghibli-card"},le={class:"form-group"},te={class:"form-group"},ae={class:"form-group"},ie=["disabled"],ne={__name:"Settings",setup(re){const p=I(),a=r({oldPassword:"",newPassword:"",confirmPassword:""}),g=r(!1),v=r(""),m=r(!1),d=r({botToken:"",channelId:""}),f=r(!1),n=r({token:"",repo:"",path:"",isPrivate:!1}),c=r(!1),u=r({botToken:"",chatId:"",proxyUrl:""}),h=r(!1);async function T(){try{const l=await y.get("/api/config",{headers:{Authorization:`Bearer ${p.token}`}});l.data.discord&&(d.value=l.data.discord),l.data.huggingface&&(n.value=l.data.huggingface),l.data.telegram&&(u.value=l.data.telegram)}catch(l){console.error("Failed to load configs:",l)}}async function U(){if(g.value=!0,v.value="",m.value=!1,a.value.newPassword!==a.value.confirmPassword){v.value="两次输入的新密码不一致，请重新输入",g.value=!1;return}const l=await p.changePassword(a.value.oldPassword,a.value.newPassword);l.success?(m.value=!0,a.value={oldPassword:"",newPassword:"",confirmPassword:""},setTimeout(()=>{m.value=!1},3e3)):v.value=l.error,g.value=!1}async function V(){var l,e;f.value=!0;try{await y.post("/api/config/discord",d.value,{headers:{Authorization:`Bearer ${p.token}`}}),alert("Discord 配置保存成功")}catch(s){alert("保存失败: "+(((e=(l=s.response)==null?void 0:l.data)==null?void 0:e.error)||s.message))}f.value=!1}async function C(){var l,e;c.value=!0;try{await y.post("/api/config/huggingface",n.value,{headers:{Authorization:`Bearer ${p.token}`}}),alert("HuggingFace 配置保存成功")}catch(s){alert("保存失败: "+(((e=(l=s.response)==null?void 0:l.data)==null?void 0:e.error)||s.message))}c.value=!1}async function B(){var l,e;h.value=!0;try{await y.post("/api/config/telegram",u.value,{headers:{Authorization:`Bearer ${p.token}`}}),alert("Telegram 配置保存成功")}catch(s){alert("保存失败: "+(((e=(l=s.response)==null?void 0:l.data)==null?void 0:e.error)||s.message))}h.value=!1}return S(()=>{T()}),(l,e)=>(P(),k("div",L,[F(H),o("div",_,[e[28]||(e[28]=o("h1",null,"设置",-1)),o("div",z,[o("div",M,[e[15]||(e[15]=o("h2",null,"修改密码",-1)),o("form",{onSubmit:w(U,["prevent"]),class:"password-form"},[o("div",$,[e[12]||(e[12]=o("label",null,"当前密码",-1)),t(o("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>a.value.oldPassword=s),type:"password",placeholder:"请输入当前密码",required:"",class:"ghibli-input"},null,512),[[i,a.value.oldPassword]])]),o("div",q,[e[13]||(e[13]=o("label",null,"新密码",-1)),t(o("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.newPassword=s),type:"password",placeholder:"请输入新密码（至少6位）",required:"",class:"ghibli-input"},null,512),[[i,a.value.newPassword]])]),o("div",E,[e[14]||(e[14]=o("label",null,"确认新密码",-1)),t(o("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.confirmPassword=s),type:"password",placeholder:"请再次输入新密码",required:"",class:"ghibli-input"},null,512),[[i,a.value.confirmPassword]])]),v.value?(P(),k("div",R,b(v.value),1)):x("",!0),m.value?(P(),k("div",j," 密码修改成功 ")):x("",!0),o("button",{type:"submit",disabled:g.value,class:"ghibli-button ghibli-button-primary submit-button"},b(g.value?"修改中...":"修改密码"),9,G)],32)]),o("div",J,[e[18]||(e[18]=o("h2",null,"Discord 配置",-1)),o("form",{onSubmit:w(V,["prevent"]),class:"config-form"},[o("div",K,[e[16]||(e[16]=o("label",null,"Bot Token",-1)),t(o("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>d.value.botToken=s),type:"text",placeholder:"请输入 Discord Bot Token",class:"ghibli-input"},null,512),[[i,d.value.botToken]])]),o("div",O,[e[17]||(e[17]=o("label",null,"Channel ID",-1)),t(o("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>d.value.channelId=s),type:"text",placeholder:"请输入频道 ID",class:"ghibli-input"},null,512),[[i,d.value.channelId]])]),o("button",{type:"submit",disabled:f.value,class:"ghibli-button ghibli-button-primary submit-button"},b(f.value?"保存中...":"保存 Discord 配置"),9,Q)],32)]),o("div",W,[e[23]||(e[23]=o("h2",null,"HuggingFace 配置",-1)),o("form",{onSubmit:w(C,["prevent"]),class:"config-form"},[o("div",X,[e[19]||(e[19]=o("label",null,"Token",-1)),t(o("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>n.value.token=s),type:"text",placeholder:"请输入 HuggingFace Token",class:"ghibli-input"},null,512),[[i,n.value.token]])]),o("div",Y,[e[20]||(e[20]=o("label",null,"Repository",-1)),t(o("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>n.value.repo=s),type:"text",placeholder:"格式: username/repo-name",class:"ghibli-input"},null,512),[[i,n.value.repo]])]),o("div",Z,[e[21]||(e[21]=o("label",null,"Path (可选)",-1)),t(o("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>n.value.path=s),type:"text",placeholder:"文件存储路径（如: images）",class:"ghibli-input"},null,512),[[i,n.value.path]])]),o("div",ee,[o("label",null,[t(o("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>n.value.isPrivate=s),type:"checkbox"},null,512),[[N,n.value.isPrivate]]),e[22]||(e[22]=A(" 私有仓库 ",-1))])]),o("button",{type:"submit",disabled:c.value,class:"ghibli-button ghibli-button-primary submit-button"},b(c.value?"保存中...":"保存 HuggingFace 配置"),9,oe)],32)]),o("div",se,[e[27]||(e[27]=o("h2",null,"Telegram 配置",-1)),o("form",{onSubmit:w(B,["prevent"]),class:"config-form"},[o("div",le,[e[24]||(e[24]=o("label",null,"Bot Token",-1)),t(o("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>u.value.botToken=s),type:"text",placeholder:"请输入 Telegram Bot Token",class:"ghibli-input"},null,512),[[i,u.value.botToken]])]),o("div",te,[e[25]||(e[25]=o("label",null,"Chat ID",-1)),t(o("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>u.value.chatId=s),type:"text",placeholder:"请输入 Chat ID",class:"ghibli-input"},null,512),[[i,u.value.chatId]])]),o("div",ae,[e[26]||(e[26]=o("label",null,"Proxy URL (可选)",-1)),t(o("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>u.value.proxyUrl=s),type:"text",placeholder:"代理域名（如: api.telegram.org）",class:"ghibli-input"},null,512),[[i,u.value.proxyUrl]])]),o("button",{type:"submit",disabled:h.value,class:"ghibli-button ghibli-button-primary submit-button"},b(h.value?"保存中...":"保存 Telegram 配置"),9,ie)],32)])])])]))}},ge=D(ne,[["__scopeId","data-v-929dff11"]]);export{ge as default};

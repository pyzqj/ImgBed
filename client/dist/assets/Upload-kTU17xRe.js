import{_ as z,u as F,c as f,f as T,a as e,w as m,n as V,t as u,d as b,b as y,g as h,h as x,r as i,i as N,o as g}from"./index-fsJvMXAk.js";import{N as S}from"./Navbar-jp9is5ex.js";import"./image-DM1O7qIR.js";const I="/discord.svg",$="/huggingface.svg",j="/telegram.svg",A={class:"upload-page"},E={class:"container"},H={class:"upload-section ghibli-card"},R={class:"drop-zone-content"},G={key:0,class:"file-info"},K={class:"file-details"},O={class:"file-name"},P={class:"file-size"},q={class:"platform-select"},J={class:"platform-options"},L={class:"platform-option"},Q={class:"platform-option"},W={class:"platform-option"},X=["disabled"],Y={key:1,class:"ghibli-error"},Z={key:2,class:"ghibli-success"},ll={class:"result-info"},el={class:"url-box"},tl=["value"],ol={__name:"Upload",setup(sl){const _=F(),p=i(!1),s=i(null),a=i("discord"),v=i(!1),d=i(""),c=i(!1),r=i(null);function C(t){p.value=!1;const l=t.dataTransfer.files;l.length>0&&(s.value=l[0])}function w(t){const l=t.target.files;l.length>0&&(s.value=l[0])}function D(){s.value=null,c.value=!1,r.value=null,d.value=""}function B(t){if(t===0)return"0 Bytes";const l=1024,o=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(t)/Math.log(l));return Math.round(t/Math.pow(l,n)*100)/100+" "+o[n]}async function M(){var l,o;if(!s.value||!a.value)return;v.value=!0,d.value="",c.value=!1;const t=new FormData;t.append("file",s.value),t.append("platform",a.value);try{const n=await N.post("/api/files/upload",t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${_.token}`}});c.value=!0,r.value=n.data}catch(n){d.value=((o=(l=n.response)==null?void 0:l.data)==null?void 0:o.error)||n.message||"上传失败"}v.value=!1}function U(){const t=r.value.accessUrl;navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(t).then(()=>{alert("已复制到剪贴板")}).catch(()=>{k(t)}):k(t)}function k(t){const l=document.createElement("textarea");l.value=t,l.style.position="fixed",l.style.left="-999999px",l.style.top="-999999px",document.body.appendChild(l),l.focus(),l.select();try{document.execCommand("copy"),alert("已复制到剪贴板")}catch{alert("复制失败，请手动复制")}document.body.removeChild(l)}return(t,l)=>(g(),f("div",A,[T(S),e("div",E,[l[19]||(l[19]=e("h1",null,"上传文件",-1)),e("div",H,[e("div",{class:V(["drop-zone",{"drag-over":p.value}]),onDragover:l[1]||(l[1]=m(o=>p.value=!0,["prevent"])),onDragleave:l[2]||(l[2]=m(o=>p.value=!1,["prevent"])),onDrop:m(C,["prevent"])},[e("input",{ref:"fileInput",type:"file",onChange:w,style:{display:"none"}},null,544),e("div",R,[l[6]||(l[6]=e("svg",{class:"upload-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("polyline",{points:"17 8 12 3 7 8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("line",{x1:"12",y1:"3",x2:"12",y2:"15","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),l[7]||(l[7]=e("p",null,"拖拽文件到此处或",-1)),e("button",{onClick:l[0]||(l[0]=o=>t.$refs.fileInput.click()),class:"ghibli-button ghibli-button-primary select-button"},"选择文件")])],34),s.value?(g(),f("div",G,[e("div",K,[e("span",O,u(s.value.name),1),e("span",P,u(B(s.value.size)),1)]),e("button",{onClick:D,class:"ghibli-button ghibli-button-secondary clear-button"},"清除")])):b("",!0),e("div",q,[l[14]||(l[14]=e("label",null,"选择上传平台",-1)),e("div",J,[e("label",L,[y(e("input",{type:"radio","onUpdate:modelValue":l[3]||(l[3]=o=>a.value=o),value:"discord"},null,512),[[h,a.value]]),l[8]||(l[8]=e("img",{src:I,alt:"Discord",class:"platform-icon-img"},null,-1)),l[9]||(l[9]=e("span",null,"Discord",-1))]),e("label",Q,[y(e("input",{type:"radio","onUpdate:modelValue":l[4]||(l[4]=o=>a.value=o),value:"huggingface"},null,512),[[h,a.value]]),l[10]||(l[10]=e("img",{src:$,alt:"HuggingFace",class:"platform-icon-img"},null,-1)),l[11]||(l[11]=e("span",null,"HuggingFace",-1))]),e("label",W,[y(e("input",{type:"radio","onUpdate:modelValue":l[5]||(l[5]=o=>a.value=o),value:"telegram"},null,512),[[h,a.value]]),l[12]||(l[12]=e("img",{src:j,alt:"Telegram",class:"platform-icon-img"},null,-1)),l[13]||(l[13]=e("span",null,"Telegram",-1))])])]),e("button",{onClick:M,disabled:!s.value||!a.value||v.value,class:"ghibli-button ghibli-button-primary upload-button"},u(v.value?"上传中...":"上传"),9,X),d.value?(g(),f("div",Y,u(d.value),1)):b("",!0),c.value?(g(),f("div",Z,[l[18]||(l[18]=e("h3",null,"上传成功!",-1)),e("div",ll,[e("p",null,[l[15]||(l[15]=e("strong",null,"文件 ID:",-1)),x(" "+u(r.value.fileId),1)]),e("p",null,[l[16]||(l[16]=e("strong",null,"平台:",-1)),x(" "+u(r.value.platform),1)]),l[17]||(l[17]=e("p",null,[e("strong",null,"访问地址:")],-1)),e("div",el,[e("input",{value:r.value.accessUrl,readonly:"",class:"ghibli-input"},null,8,tl),e("button",{onClick:U,class:"ghibli-button ghibli-button-primary copy-button"},"复制")])])])):b("",!0)])])]))}},rl=z(ol,[["__scopeId","data-v-895adb1a"]]);export{rl as default};
